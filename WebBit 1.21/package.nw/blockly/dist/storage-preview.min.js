!function(a,t){"undefined"==typeof exports?a.PreviewStorage=t():module.exports=t()}(window,function(){"use strict";var a,t=window.location,e=window.XMLHttpRequest;function n(a){this._root=a,this._ajax=null}function o(a,n,o,i){switch(a._ajax&&a._ajax.abort(),a._ajax=new e,a._ajax.name=n,a._ajax.onreadystatechange=function(a,e){if(4===a._ajax.readyState){if(200!=a._ajax.status)e(new Error(a._ajax.status));else{var n=a._ajax.responseText.trim();"data"===a._ajax.name?e(null,(t.protocol+"//"+t.host+t.pathname).split("/")+"#"+JSON.parse(n).hashid):"key"===a._ajax.name&&(n.length?e(null,JSON.parse(n).datum):e(new Error("Unmatched Key: "+window.location.hash)))}a._ajax=null}}.bind(null,a,i),n){case"data":a._ajax.open("POST",`${a._root}/api/storages/link`),a._ajax.setRequestHeader("Content-Type","application/json;charset=UTF-8"),a._ajax.send(JSON.stringify({datum:o}));break;case"key":a._ajax.open("GET",`${a._root}/api/storages/link?hashid=${o}`),a._ajax.send()}}return(a=n.prototype).link=function(a,t){o(this,"data",a,t)},a.retrieve=function(a,t){o(this,"key",a,t)},n});