!function(t){"undefined"==typeof exports?t(window,window.webduino):module.exports=t}(function(t,e){"use strict";t.getMatrix=function(t,_,n){return new e.module.Matrix(t,_,n)},t.getButton=function(t,_){return new e.module.Button(t,t.getDigitalPin(_))},t.getMPU9250=function(t){return new e.module.MPU9250(t)},t.getPhotocell=function(t,_){return new e.module.Photocell(t,_)},t.getBuzzer=function(t,_){return new e.module.Buzzer(t,t.getDigitalPin(_))},t.getThermistor=function(t,_){return new e.module.Thermistor(t,_)},t.textInput=function(){let t=document.getElementById("inputArea"),e=document.getElementById("input"),_=document.getElementById("send");return t.className="show",e.value="",e.focus(),new Promise(function(n){let o=()=>{window.thisInputVal=e.value,t.className="",_.removeEventListener("click",o),e.removeEventListener("change",o),n()};setTimeout(()=>{_.addEventListener("click",o),e.addEventListener("change",o)})})},t.keyboardEvent=function(){window.keyDownCode={},window.keyUpCode={},document.onkeydown=function(t){if(keyDownCode["code"+t.keyCode]){(0,keyDownCode["code"+t.keyCode])()}},document.onkeyup=function(t){keyUpCode["code"+t.keyCode]&&keyUpCode["code"+t.keyCode]()}},t.speakAsync=function(t,e){window.speechSynthesis.cancel();let _=new SpeechSynthesisUtterance(t);return _.lang=e[0],_.pitch=e[1],_.rate=e[2],window.speechSynthesis.speak(_),new Promise(e=>{_.onend=(()=>{console.log(t),e()})})},t._loop_=!0,t.boardInit_=function(t,e,_){let n,o;switch(t._options.transport){case"mqtt":n="WiFi",o=t._options.device;break;case"message":n="Simulator",o="Simulator";break;case"websocket":n="USB",o="USB"}gtag("event",n,{event_category:"boardReady",event_label:o});let i={};return t.samplingInterval=e,i._bit_matrix_=getMatrix(t,4,25),i._bit_btnA_=getPullupButton(t,35),i._bit_btnB_=getPullupButton(t,27),i._bit_buzzer_=getBuzzer(t,25),i._bit_buzzer_.buzzerPlaying_=!0,i._bit_pLeft_=getPhotocell(t,0),i._bit_pRight_=getPhotocell(t,3),i._bit_temp_=getThermistor(t,6),i._bit_mpu9250_=getMPU9250(t),i._bit_mpu9250_.setDetectTimeType(_),new Promise(t=>{t(i)})},t.detectInit_=function(t,_,n,o,i,a,u,r,c){return t._bit_detected_val_={},t._bit_detected_val_.temp=37.91,t._bit_detected_val_.left=220,t._bit_detected_val_.right=132,t._bit_mpu9250_val_={},t._bit_mpu9250_val_.azi=0,t._bit_mpu9250_val_.row=0,t._bit_mpu9250_val_.pitch=0,t._bit_mpu9250_val_.yaw=0,t._bit_mpu9250_val_.accX=0,t._bit_mpu9250_val_.accY=0,t._bit_mpu9250_val_.accZ=0,t._bit_mpu9250_val_.gyrX=0,t._bit_mpu9250_val_.gyrY=0,t._bit_mpu9250_val_.gyrZ=0,t._bit_mpu9250_val_.magX=0,t._bit_mpu9250_val_.magY=0,t._bit_mpu9250_val_.magZ=0,1==_&&t._bit_temp_.measure(function(e){t._bit_detected_val_.temp=Math.round(100*e)/100}),1==n&&t._bit_pLeft_.measure(function(e){t._bit_detected_val_.left=Math.round(1e3*e)}),1==o&&t._bit_pRight_.measure(function(e){t._bit_detected_val_.right=Math.round(1e3*e)}),1==i&&t._bit_mpu9250_.on(e.module.MPU9250Event.AZIMUTH_MESSAGE,function(){t._bit_mpu9250_val_.azi=1*t._bit_mpu9250_.aziVals[0]}),1==a&&t._bit_mpu9250_.on(e.module.MPU9250Event.ACCELEROMETER_MESSAGE,function(){t._bit_mpu9250_val_.accX=1*t._bit_mpu9250_.accVals[0],t._bit_mpu9250_val_.accY=1*t._bit_mpu9250_.accVals[1],t._bit_mpu9250_val_.accZ=1*t._bit_mpu9250_.accVals[2]}),1==u&&t._bit_mpu9250_.on(e.module.MPU9250Event.GYROSCOPE_MESSAGE,function(){t._bit_mpu9250_val_.gyrX=1*t._bit_mpu9250_.gyrVals[0],t._bit_mpu9250_val_.gyrY=1*t._bit_mpu9250_.gyrVals[1],t._bit_mpu9250_val_.gyrZ=1*t._bit_mpu9250_.gyrVals[2]}),1==r&&t._bit_mpu9250_.on(e.module.MPU9250Event.MAGNETOMETER_MESSAGE,function(){t._bit_mpu9250_val_.magX=1*t._bit_mpu9250_.magVals[0],t._bit_mpu9250_val_.magY=1*t._bit_mpu9250_.magVals[1],t._bit_mpu9250_val_.magZ=1*t._bit_mpu9250_.magVals[2]}),1==c&&t._bit_mpu9250_.on(e.module.MPU9250Event.ANGLE_MESSAGE,function(){t._bit_mpu9250_val_.row=1*t._bit_mpu9250_.angVals[0],t._bit_mpu9250_val_.pitch=1*t._bit_mpu9250_.angVals[1],t._bit_mpu9250_val_.yaw=1*t._bit_mpu9250_.angVals[2]}),new Promise(t=>{setTimeout(t,500)})},t.buzzer_music=function(t){let e={notes:[],tempos:[]};if(t[0].notes.length>1)for(var _=0;_<t.length;_++){if(Array.isArray(t[_].notes)){let n=e.notes.concat(t[_].notes);e.notes=n}else e.notes.push(t[_].notes);if(Array.isArray(t[_].tempos)){let n=e.tempos.concat(t[_].tempos);e.tempos=n}else e.tempos.push(t[_].tempos)}else e.notes=[t[0].notes],e.tempos=[t[0].tempos];return e},t.buzzerPlay_=async function(t,e,_){let n=e,o=_;if(Array.isArray(n[0])&&(n=n[0]).forEach((t,e)=>{null==t&&(n[e]="0")}),Array.isArray(o[0])&&(o=o[0]).forEach((t,e)=>{null==t&&(o[e]=2)}),0==n.length&&(n=["0"]),0==o.length&&(o=[2]),n.length>o.length){let t=o.length,e=n.length-o.length,_=o[o.length-1];for(let n=0;n<e;n++)o[t+n]=_}if(n.length<o.length){let t=n.length,e=o.length-n.length,_=n[n.length-1];for(let o=0;o<e;o++)n[t+o]=_}if(t._bit_buzzer_.buzzerPlaying_){t._bit_buzzer_.buzzerThis={};let e="t"+(new Date).getTime();t._bit_buzzer_.buzzerThis[e]=!0,t._bit_buzzer_.play(n,o);let _=function(t){return new Promise(e=>{setTimeout(e,t)})};for(;t._bit_buzzer_.buzzerPlaying_&&t._bit_buzzer_.buzzerThis[e]&&"stopped"!=t._bit_buzzer_._state&&"stop"!=t._bit_buzzer_._state;)await _(10);return new Promise(t=>{t()})}},t.buzzerPlayEvent_=function(t,e){switch(e){case"stop":t._bit_buzzer_.buzzerPlaying_=!1,t._bit_buzzer_.stop(),setTimeout(function(){t._bit_buzzer_.buzzerPlaying_=!0},50);break;case"pause":t._bit_buzzer_.pause();break;case"play":t._bit_buzzer_.play()}},t.mpu9250Fn_={},mpu9250Fn_.shake=async function(t,e){t.shakeStop=!1;let _=function(e){return Math.abs(t._bit_mpu9250_val_.gyrX)+Math.abs(t._bit_mpu9250_val_.gyrY)+Math.abs(t._bit_mpu9250_val_.gyrZ)>90?t.shakeStop||(t.shakeStop=!0,e()):t.shakeStop=!1,new Promise(t=>{setTimeout(t,100)})};for(;;)await _(e)},mpu9250Fn_.peace=async function(t,e){t.peaceStop=!1;let _=function(e){return Math.abs(t._bit_mpu9250_val_.gyrX)+Math.abs(t._bit_mpu9250_val_.gyrY)+Math.abs(t._bit_mpu9250_val_.gyrZ)<=90?t.peaceStop||(t.peaceStop=!0,e()):t.peaceStop=!1,new Promise(t=>{setTimeout(t,100)})};for(;;)await _(e)},mpu9250Fn_.rowForward=async function(t,e){t.rowForwardStop=!1;let _=function(e){return t._bit_mpu9250_val_.row>=-150&&t._bit_mpu9250_val_.row<=-100&&!t.pitchRightStop&&!t.pitchLeftStop?t.rowForwardStop||(t.rowForwardStop=!0,e()):t.rowForwardStop=!1,new Promise(t=>{setTimeout(t,100)})};for(;;)await _(e)},mpu9250Fn_.rowBack=async function(t,e){t.rowBackStop=!1;let _=function(e){return t._bit_mpu9250_val_.row>=100&&t._bit_mpu9250_val_.row<=150&&!t.pitchRightStop&&!t.pitchLeftStop?t.rowBackStop||(t.rowBackStop=!0,e()):t.rowBackStop=!1,new Promise(t=>{setTimeout(t,100)})};for(;;)await _(e)},mpu9250Fn_.pitchLeft=async function(t,e){t.pitchLeftStop=!1;let _=function(e){return t._bit_mpu9250_val_.pitch>=30&&!t.rowBackStop&&!t.rowForwardStop?t.pitchLeftStop||(t.pitchLeftStop=!0,e()):t.pitchLeftStop=!1,new Promise(t=>{setTimeout(t,100)})};for(;;)await _(e)},mpu9250Fn_.pitchRight=async function(t,e){t.pitchRightStop=!1;let _=function(e){return t._bit_mpu9250_val_.pitch<=-30&&!t.rowBackStop&&!t.rowForwardStop?t.pitchRightStop||(t.pitchRightStop=!0,e()):t.pitchRightStop=!1,new Promise(t=>{setTimeout(t,100)})};for(;;)await _(e)},mpu9250Fn_.turnLeft=mpu9250Fn_.pitchLeft,mpu9250Fn_.turnRight=mpu9250Fn_.pitchRight,mpu9250Fn_.faceFront=async function(t,e){t.faceFrontStop=!1;let _=function(e){return!(t._bit_mpu9250_val_.accZ<=-30)||t.rowBackStop||t.rowForwardStop||t.pitchRightStop||t.pitchLeftStop?t.faceFrontStop=!1:t.faceFrontStop||(t.faceFrontStop=!0,e()),new Promise(t=>{setTimeout(t,100)})};for(;;)await _(e)},mpu9250Fn_.faceBack=async function(t,e){t.faceBackStop=!1;let _=function(e){return t._bit_mpu9250_val_.accZ>=30?t.faceBackStop||(t.faceBackStop=!0,e()):t.faceBackStop=!1,new Promise(t=>{setTimeout(t,100)})};for(;;)await _(e)},mpu9250Fn_.faceNorth=async function(t,e){t.faceNorthStop=!1;let _=function(e){let _=t._bit_mpu9250_val_.azi;return _<0&&(_+=360),_>=0&&_<=30||_>=330&&_<=360?t.faceNorthStop||(t.faceNorthStop=!0,e()):t.faceNorthStop=!1,new Promise(t=>{setTimeout(t,100)})};for(;;)await _(e)},mpu9250Fn_.faceEast=async function(t,e){t.faceEastStop=!1;let _=function(e){let _=t._bit_mpu9250_val_.azi;return _<0&&(_+=360),_>=60&&_<=120?t.faceEastStop||(t.faceEastStop=!0,e()):t.faceEastStop=!1,new Promise(t=>{setTimeout(t,100)})};for(;;)await _(e)},mpu9250Fn_.faceSouth=async function(t,e){t.faceSouthStop=!1;let _=function(e){let _=t._bit_mpu9250_val_.azi;return _<0&&(_+=360),_>=150&&_<=210?t.faceSouthStop||(t.faceSouthStop=!0,e()):t.faceSouthStop=!1,new Promise(t=>{setTimeout(t,100)})};for(;;)await _(e)},mpu9250Fn_.faceWest=async function(t,e){t.faceWestStop=!1;let _=function(e){let _=t._bit_mpu9250_val_.azi;return _<0&&(_+=360),_>=240&&_<=300?t.faceWestStop||(t.faceWestStop=!0,e()):t.faceWestStop=!1,new Promise(t=>{setTimeout(t,100)})};for(;;)await _(e)},t.emojiList_=["0000001010000001000101110","0000001010000000111010001","1000101010001001101111011","0111011111111110111001110","1010101110111110111010101","0000001010011100010000000","0101011111111110111000100","0101010101100010101000100","0000000100011101111100000","0000011111011100010000000","0001000110011100011000010","0100001100011100110001000","0000000001000110011101111","0000010000110001110011110","0111100111000110000100000","1111011100110001000000000","0010001110101010010000100","0010000100101010111000100","0010001000111110100000100","0010000010111110001000100","1110011000101000001000001","0011100011001010100010000","0000100010101001100011100","1000001000001010001100111","1000111011111111101110001","1111101110001000111011111","1000111010111001101010001","1000101011001110101110001","0000000000001000000000000","0000000100000000010000000","0000000100000000101000000","0000001010000000101000000","0000001010001000101000000","0101000000010100000001010","0000001110010100111000000","0000001110011100111000000","0111010001100011000101110","0010001110111110111000100","0010001010100010101000100","1111110001101011000111111","1111110101111111010111111","0010001010101010101000100","0010010101011100101010001","0000100010101000100000000","0011000101001001110011100","0111101001010011101111011","0101011111010101111101010","0111101111011110100001000","1111111011101011101111111","0111001110001001111100100","0010100010111011010011100","1010101010101010101010101","0010010110111111011000100","1010110101111111000111111","1111100000111110000011111","0000011111000001111100000","0010000100111110010000100","0000000000111110000000000","1000101010001000101010001","0010000000111110000000100"],t.matrixEmoji_=function(t,e){let _,n,o="";return n=e.replace("#",""),(_=t.split("")).forEach((t,e)=>{let _=e.toString(16);parseInt(e)<16&&(_="0"+_),o+=t=t<1?_+"000000":_+n}),o},t.btnEvent_=function(t,e,_,n){let o={pressed:[],released:[],longPress:[]};return["pressed","released","longPress"].forEach(t=>{n.forEach(e=>{e.on(t,function(){e.statusRec=e.statusRec||{},e.statusRec[t]=Date.now(),function(t,e){let _=o[t].filter(t=>t.target===e);0!==_.length&&setTimeout((t,e)=>{let o=n.filter(t=>t!==e),i=e.statusRec[t];o.every(e=>e.statusRec&&e.statusRec[t]&&Math.abs(i-e.statusRec[t])<100)||_.forEach(t=>t.fn())},100,t,e)}(t,e)})})}),o[e].push({target:t,fn:_}),function(t,e,_){o[e].push({target:t,fn:_})}},t.btnsEvent_=function(t,e,_){let n={pressed:[],released:[],longPress:[]};return["pressed","released","longPress"].forEach(t=>{_.forEach(e=>{e.on(t,function(){var o;e.statusRec=e.statusRec||{},e.statusRec[t]=Date.now(),o=t,_.every(t=>t.statusRec&&Math.abs(Date.now()-t.statusRec[o])<100)&&setTimeout(function(){n[o].forEach(t=>t())},100)})})}),n[t].push(e),function(t,e){n[t].push(e)}},t.speechValue_="",t.speechRecognition=function(t){return new Promise(e=>{let _=new webkitSpeechRecognition,n=0;_.continuous=!0,_.interimResults=!0,_.lang=t,_.onstart=function(){n=1,console.log("開始辨識...")},_.onend=function(){console.log("停止辨識!"),n>0&&_.start()},_.onresult=function(t){speechValue_=t.results[0][0].transcript,setTimeout(()=>{n=0,_.stop(),e()},2e3)},_.start()})}});