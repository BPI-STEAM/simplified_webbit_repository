!function(){var e="undefined"!=typeof exports&&exports||"undefined"!=typeof define&&{}||this;e.svgAsDataUri=function(e,t,n){(t=t||{}).scale=t.scale||1;var r="http://www.w3.org/2000/xmlns/";!function(e,t){var n=e.querySelectorAll("image"),r=n.length;0==r&&t();for(var o=0;o<n.length;o++)!function(e){var n=e.getAttributeNS("http://www.w3.org/1999/xlink","href");if(n&&(o=n.value)&&0==o.lastIndexOf("http",0)&&-1==o.lastIndexOf(window.location.host))console.warn("Cannot render embedded images linking to external hosts: "+n.value);else{var o,i=document.createElement("canvas"),a=i.getContext("2d"),l=new Image;n=n||e.getAttribute("href"),l.src=n,l.onload=function(){i.width=l.width,i.height=l.height,a.drawImage(l,0,0),e.setAttributeNS("http://www.w3.org/1999/xlink","href",i.toDataURL("image/png")),0==--r&&t()},l.onerror=function(){console.log("Could not load "+n),0==--r&&t()}}}(n[o])}(e,function(){var o=document.createElement("div"),i=e.cloneNode(!0);i.setAttribute("transform",i.getAttribute("transform").replace(/translate\(.*?\)/,"")),(g=document.createElementNS("http://www.w3.org/2000/svg","svg")).appendChild(i),i=g;var a=e.getBBox(),l=e.getBoundingClientRect();i.setAttribute("version","1.1"),null!==i.getAttribute("xmlns")&&i.removeAttribute("xmlns"),null!==i.getAttribute("xmlns:xlink")&&i.removeAttribute("xmlns:xlink"),i.setAttributeNS(r,"xmlns","http://www.w3.org/2000/svg"),i.setAttributeNS(r,"xmlns:xlink","http://www.w3.org/1999/xlink"),i.setAttribute("width",l.width),i.setAttribute("height",l.height),i.setAttribute("viewBox",[a.x,a.y,l.width,l.height].join(" ")),o.appendChild(i);var s=function(e,t){for(var n="",r=document.styleSheets,o=0;o<r.length;o++){try{var i=r[o].cssRules}catch(e){console.warn("Stylesheet could not be loaded: "+r[o].href);continue}if(null!=i)for(var a=0;a<i.length;a++){var l=i[a];if(void 0!==l.style){var s=null;try{s=e.querySelector(l.selectorText)}catch(e){console.warn('Invalid CSS selector "'+l.selectorText+'"',e)}s?n+=(t?t(l.selectorText):l.selectorText)+" { "+l.style.cssText+" }\n":l.cssText.match(/^@font-face/)&&(n+=l.cssText+"\n")}}}return n}(e,t.selectorRemap),c=document.createElement("style");c.setAttribute("type","text/css"),c.innerHTML="<![CDATA[\n"+s+"\n]]>";var d=document.createElement("defs");d.appendChild(c),i.insertBefore(d,i.firstChild);var u,g='<?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">'+o.innerHTML.replace(/&nbsp;/g," "),h="data:image/svg+xml;base64,"+window.btoa((u=g,u=(u=encodeURIComponent(u)).replace(/%([0-9A-F]{2})/g,function(e,t){var n=String.fromCharCode("0x"+t);return"%"===n?"%25":n}),decodeURIComponent(u)));n&&n(h)})},e.svgAsPngUri=function(t,n,r){e.svgAsDataUri(t,n,function(e){var t=new Image;t.onload=function(){var e=document.createElement("canvas");e.width=t.width,e.height=t.height;var o=e.getContext("2d");n&&n.backgroundColor&&(o.fillStyle=n.backgroundColor,o.fillRect(0,0,e.width,e.height)),o.drawImage(t,0,0);var i;document.createElement("a");try{i=e.toDataURL("image/png")}catch(e){if("undefined"!=typeof SecurityError&&e instanceof SecurityError||"SecurityError"==e.name)return void console.error("Rendered SVG images cannot be downloaded in this browser.");throw e}r(i)},t.src=e})},e.saveSvgAsPng=function(t,n,r){r=r||{},e.svgAsPngUri(t,r,function(e){var t=document.createElement("a");t.download=n,t.href=e,document.body.appendChild(t),t.addEventListener("click",function(e){t.parentNode.removeChild(t)}),t.click()})},"undefined"!=typeof define&&define(function(){return e})}();